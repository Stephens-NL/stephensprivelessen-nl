<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes Dashboard - Stephen's Privelessen</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            color: #1a202c;
            line-height: 1.6;
        }
        
        .app-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* Hero Section */
        .hero-section {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            padding: 2rem 1.5rem;
            position: relative;
            overflow: hidden;
        }
        
        .hero-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
            width: 100%;
        }
        
        .hero-left {
            z-index: 2;
        }
        
        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            padding: 0.5rem 1rem;
            margin-bottom: 2rem;
            color: white;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .badge-icon {
            font-size: 1.2rem;
        }
        
        .hero-title {
            font-size: 3.5rem;
            font-weight: 800;
            line-height: 1.1;
            margin-bottom: 1.5rem;
            color: white;
        }
        
        .gradient-text {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero-description {
            font-size: 1.25rem;
            line-height: 1.6;
            margin-bottom: 2.5rem;
            color: rgba(255, 255, 255, 0.9);
            max-width: 500px;
        }
        
        .search-container {
            margin-bottom: 2rem;
        }
        
        .search-input-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            max-width: 500px;
        }
        
        .search-input {
            flex: 1;
            padding: 1rem 1.5rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .search-input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.15);
            color: white;
        }
        
        .search-input:focus::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .search-button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            border: none;
            border-radius: 50px;
            color: #1a202c;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .search-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.3);
        }
        
        .language-toggle {
            display: flex;
            gap: 0.5rem;
        }
        
        .lang-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-1px);
        }
        
        .lang-btn.active {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
        }
        
        .hero-features {
            display: flex;
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .feature {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }
        
        .feature-icon {
            font-size: 1.2rem;
        }
        
        .hero-visual {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        
        .floating-cards {
            position: relative;
            width: 100%;
            height: 400px;
        }
        
        .card {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 1.5rem;
            color: white;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            animation: float 6s ease-in-out infinite;
        }
        
        .card-1 {
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }
        
        .card-2 {
            top: 50%;
            right: 20%;
            animation-delay: 2s;
        }
        
        .card-3 {
            bottom: 20%;
            left: 30%;
            animation-delay: 4s;
        }
        
        .card-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .card-subtitle {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        .results-section {
            background: #f8fafc;
            min-height: 100vh;
            padding: 2rem 1.5rem;
        }
        
        /* When hero section is hidden, make results section full height */
        .hero-section[style*="display: none"] + .results-section {
            min-height: 100vh;
            padding-top: 1rem;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .hero-content {
                grid-template-columns: 1fr;
                gap: 2rem;
                text-align: center;
            }
            
            .hero-title {
                font-size: 2.5rem;
            }
            
            .hero-description {
                font-size: 1.1rem;
            }
            
            .search-input-group {
                flex-direction: column;
                gap: 1rem;
            }
            
            .search-button {
                width: 100%;
                justify-content: center;
            }
            
            .hero-features {
                justify-content: center;
                flex-wrap: wrap;
                gap: 1rem;
            }
            
            .floating-cards {
                height: 300px;
            }
            
            .card {
                padding: 1rem;
            }
            
            .card-1 {
                top: 10%;
                left: 5%;
            }
            
            .card-2 {
                top: 40%;
                right: 10%;
            }
            
            .card-3 {
                bottom: 10%;
                left: 20%;
            }
        }
        
        @media (max-width: 480px) {
            .hero-section {
                padding: 1rem;
            }
            
            .hero-title {
                font-size: 2rem;
            }
            
            .hero-description {
                font-size: 1rem;
            }
            
            .search-input {
                padding: 0.875rem 1.25rem;
            }
            
            .search-button {
                padding: 0.875rem 1.5rem;
            }
            
            .lang-btn {
                padding: 0.625rem 1.25rem;
                font-size: 0.8rem;
            }
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            padding: 2rem 1.5rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }
        
        /* Search Section */
        .search-section {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            margin-bottom: 2rem;
            border: 1px solid #e2e8f0;
        }
        
        .search-box {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .search-input {
            flex: 1;
            padding: 1rem 1.5rem;
            border: 2px solid #e2e8f0;
            border-radius: 0.75rem;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            background: #f8fafc;
            color: #1a202c;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            color: #1a202c;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .search-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .search-btn:disabled {
            background: #94a3b8;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* Loading States */
        .loading {
            text-align: center;
            padding: 3rem;
        }
        
        .spinner {
            width: 3rem;
            height: 3rem;
            border: 4px solid #e2e8f0;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1.5rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error {
            background: #fef2f2;
            color: #dc2626;
            padding: 1rem;
            border-radius: 0.75rem;
            border: 1px solid #fecaca;
            text-align: center;
            margin: 1rem 0;
        }
        
        .no-results {
            text-align: center;
            padding: 3rem 2rem;
            color: #64748b;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .no-results-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }
        
        .no-results h3 {
            color: #334155;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }
        
        .no-results p {
            margin-bottom: 1.5rem;
            color: #64748b;
        }
        
        .suggestions-list {
            text-align: left;
            margin: 1.5rem 0;
            padding: 0;
            list-style: none;
        }
        
        .suggestions-list li {
            padding: 0.5rem 0;
            color: #555;
            border-bottom: 1px solid #eee;
        }
        
        .suggestions-list li:last-child {
            border-bottom: none;
        }
        
        .search-again {
            margin-top: 2rem;
        }
        
        .retry-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .retry-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        /* Stats */
        .stats {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            padding: 1rem;
            border-radius: 0.75rem;
            text-align: center;
            margin-bottom: 1.5rem;
            font-weight: 600;
            color: #475569;
            border: 1px solid #cbd5e1;
        }
        
        /* Student Cards */
        .student-card {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            border: 1px solid #e2e8f0;
        }
        
        .student-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
            border-color: #667eea;
        }
        
        .student-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .student-name {
            font-size: 1.4rem;
            font-weight: 700;
            color: #1e293b;
        }
        
        .subject-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 1.5rem;
            font-size: 0.85rem;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }
        
        .student-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .last-activity {
            color: #64748b;
            font-size: 0.95rem;
        }
        
        .file-count {
            background: #f1f5f9;
            color: #475569;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.8rem;
            font-weight: 600;
            border: 1px solid #cbd5e1;
        }
        
        .click-hint {
            text-align: center;
            color: #667eea;
            font-size: 0.9rem;
            font-weight: 600;
            margin-top: 0.5rem;
        }
        
        /* Featured Note Section */
        .featured-note {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
        }
        
        .featured-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f1f5f9;
        }
        
        .featured-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
        }
        
        .featured-subject {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 1.5rem;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .featured-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 2rem;
            align-items: start;
        }
        
        .featured-preview {
            background: #f8fafc;
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
            border: 2px solid #e2e8f0;
        }
        
        .featured-preview img {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .featured-details {
            padding: 1rem 0;
        }
        
        .featured-summary {
            background: #f8fafc;
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
            border-left: 4px solid #667eea;
        }
        
        .featured-summary h4 {
            color: #1e293b;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }
        
        .featured-summary p {
            color: #64748b;
            line-height: 1.6;
        }
        
        .featured-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .meta-item {
            background: #f1f5f9;
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            border: 1px solid #e2e8f0;
        }
        
        .meta-label {
            font-size: 0.8rem;
            color: #64748b;
            margin-bottom: 0.25rem;
            font-weight: 600;
        }
        
        .meta-value {
            font-size: 1rem;
            color: #1e293b;
            font-weight: 700;
        }
        
        .featured-actions {
            display: flex;
            gap: 1rem;
        }
        
        .action-btn {
            flex: 1;
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
            display: inline-block;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }
        
        .btn-secondary:hover {
            background: #667eea;
            color: white;
        }
        
        /* Files Section */
        .files-section {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
        }
        
        .files-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f1f5f9;
        }
        
        .files-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
        }
        
        .filters-section {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .filter-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: #475569;
        }
        
        .filter-select {
            padding: 0.75rem 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 0.5rem;
            background: white;
            font-size: 0.9rem;
            color: #1e293b;
            cursor: pointer;
            transition: border-color 0.3s ease;
        }
        
        .filter-select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .clear-filters {
            background: #f1f5f9;
            color: #64748b;
            border: 1px solid #cbd5e1;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .clear-filters:hover {
            background: #e2e8f0;
            color: #475569;
        }
        
        /* Share Button */
        .share-section {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
        }
        
        .share-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .share-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #1e293b;
        }
        
        .share-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .share-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: white;
        }
        
        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .share-btn.whatsapp {
            background: #25d366;
        }
        
        .share-btn.whatsapp:hover {
            background: #20ba5a;
        }
        
        .share-btn.email {
            background: #667eea;
        }
        
        .share-btn.email:hover {
            background: #5a67d8;
        }
        
        .share-btn.copy {
            background: #6b7280;
        }
        
        .share-btn.copy:hover {
            background: #4b5563;
        }
        
        .share-url {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 0.75rem;
            font-size: 0.9rem;
            color: #64748b;
            word-break: break-all;
            margin-top: 1rem;
        }
        
        .copy-success {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: #10b981;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .view-toggle {
            display: flex;
            gap: 0.5rem;
            background: #f1f5f9;
            padding: 0.5rem;
            border-radius: 0.75rem;
            border: 1px solid #e2e8f0;
        }
        
        .toggle-btn {
            background: transparent;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #64748b;
        }
        
        .toggle-btn.active {
            background: white;
            color: #667eea;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .toggle-btn:hover:not(.active) {
            color: #475569;
        }
        
        /* File Grid */
        .file-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        
        .file-card {
            background: #f8fafc;
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #e2e8f0;
        }
        
        .file-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
            border-color: #667eea;
            background: white;
        }
        
        .file-preview {
            width: 80px;
            height: 80px;
            margin: 0 auto 1rem;
            border-radius: 0.5rem;
            overflow: hidden;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #e2e8f0;
        }
        
        .file-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .file-icon {
            font-size: 2rem;
            color: #94a3b8;
        }
        
        .file-name {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            line-height: 1.3;
        }
        
        .file-date {
            color: #64748b;
            font-size: 0.8rem;
            margin-bottom: 0.75rem;
        }
        
        .file-meta {
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid #e2e8f0;
        }
        
        .file-subject {
            color: #667eea;
            font-weight: 600;
            font-size: 0.8rem;
            margin-bottom: 0.25rem;
        }
        
        .file-topic {
            color: #059669;
            font-size: 0.75rem;
            margin-bottom: 0.25rem;
        }
        
        .file-keywords {
            color: #64748b;
            font-size: 0.7rem;
        }
        
        /* Back Button */
        .back-btn {
            background: #6b7280;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s ease;
            margin-bottom: 1.5rem;
        }
        
        .back-btn:hover {
            background: #4b5563;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 1.5rem 1rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .language-toggle {
                position: static;
                justify-content: center;
                margin-top: 1rem;
            }
            
            .main-content {
                padding: 1rem;
            }
            
            .search-box {
                flex-direction: column;
            }
            
            .featured-content {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .featured-actions {
                flex-direction: column;
            }
            
            .file-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 1rem;
            }
            
            .share-buttons {
                flex-direction: column;
            }
            
            .share-btn {
                justify-content: center;
            }
            
            .filters-section {
                flex-direction: column;
                align-items: stretch;
            }
            
            .filter-group {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Hero Section -->
        <div class="hero-section">
            <div class="hero-content">
                <div class="hero-left">
                    <div class="hero-badge">
                        <span class="badge-icon">📚</span>
                        <span class="badge-text">Stephen's Privelessen</span>
                    </div>
                    
                    <h1 class="hero-title" id="hero-title">
                        Vind je <span class="gradient-text">aantekeningen</span> in seconden
                    </h1>
                    
                    <p class="hero-description" id="hero-description">
                        Alle je notities, georganiseerd en direct toegankelijk. Voer gewoon je naam in en vind al je lesmateriaal.
                    </p>
                    
                    <div class="search-container">
                        <div class="search-input-group">
                            <input 
                                type="text" 
                                id="searchInput" 
                                placeholder="Typ je naam om je aantekeningen te vinden..." 
                                class="search-input"
                                autocomplete="off"
                            />
                            <button id="searchBtn" class="search-button">
                                <span class="search-icon">🔍</span>
                                <span class="search-text" id="search-text">Zoeken</span>
                            </button>
                        </div>
                        
                        <div class="language-toggle">
                            <button id="langNl" class="lang-btn active">
                                <span class="flag">🇳🇱</span>
                                <span class="lang-text">Nederlands</span>
                            </button>
                            <button id="langEn" class="lang-btn">
                                <span class="flag">🇬🇧</span>
                                <span class="lang-text">English</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="hero-features">
                        <div class="feature">
                            <span class="feature-icon">⚡</span>
                            <span class="feature-text" id="feature-fast">Snel zoeken</span>
                        </div>
                        <div class="feature">
                            <span class="feature-icon">🔒</span>
                            <span class="feature-text" id="feature-secure">Privacy veilig</span>
                        </div>
                        <div class="feature">
                            <span class="feature-icon">📱</span>
                            <span class="feature-text" id="feature-mobile">Mobiel vriendelijk</span>
                        </div>
                    </div>
                </div>
                
                <div class="hero-visual">
                    <div class="floating-cards">
                        <div class="card card-1">
                            <div class="card-icon">📝</div>
                            <div class="card-title">Wiskunde</div>
                            <div class="card-subtitle">Algebra & Functies</div>
                        </div>
                        <div class="card card-2">
                            <div class="card-icon">🧪</div>
                            <div class="card-title">Scheikunde</div>
                            <div class="card-subtitle">Fases & Stoffen</div>
                        </div>
                        <div class="card card-3">
                            <div class="card-icon">⚡</div>
                            <div class="card-title">Natuurkunde</div>
                            <div class="card-subtitle">Mechanica</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Results Section -->
        <div id="results" class="results-section"></div>
    </div>

    <script>
        let currentResults = [];
        let currentStudent = null;
        let currentView = 'icon';
        let currentLanguage = 'nl';
        let currentFiles = [];
        let currentFilters = {
            subject: 'all',
            schoolYear: 'all'
        };
        
        // Translations
        const translations = {
            'nl': {
                'search_placeholder': 'Typ je naam om je aantekeningen te vinden...',
                'search_button': '🔍 Zoeken',
                'loading': 'Laden...',
                'no_results': 'Geen studenten gevonden',
                'try_again': 'Probeer een andere naam of controleer de spelling.',
                'students_found': 'studenten gevonden',
                'student_found': 'student gevonden',
                'last_activity': 'Laatste activiteit',
                'files': 'Bestanden',
                'click_to_view': '👆 Klik om details te bekijken',
                'back_to_search': '← Terug naar zoeken',
                'icon_view': 'Icon View',
                'list_view': 'List View',
                'no_files': 'Geen bestanden gevonden in deze map.',
                'error_loading': 'Fout bij laden van bestanden. Probeer opnieuw.',
                'error_loading_files': 'Fout bij laden',
                'hover_to_load': 'Hover om te laden',
                'latest_note': 'Laatste aantekening',
                'preview': 'Preview',
                'download': 'Download',
                'all_files': 'Alle bestanden',
                'subject': 'Vak',
                'topic': 'Onderwerp',
                'level': 'Niveau',
                'keywords': 'Trefwoorden',
                'summary': 'Samenvatting',
                'filter_subject': 'Filter op vak',
                'filter_year': 'Filter op schooljaar',
                'clear_filters': 'Filters wissen',
                'all_subjects': 'Alle vakken',
                'all_years': 'Alle schooljaren',
                'share_notes': 'Deel je aantekeningen',
                'share_whatsapp': 'Deel via WhatsApp',
                'share_email': 'Deel via e-mail',
                'copy_link': 'Kopieer link',
                'link_copied': 'Link gekopieerd!',
                'share_message': 'Bekijk mijn aantekeningen van Stephen\'s Privelessen:',
                'enter_name_to_search': 'Voer een naam in om te zoeken',
                'no_notes_found': 'Geen aantekeningen gevonden',
                'no_files_available': 'Er zijn nog geen bestanden beschikbaar voor deze student.',
                'no_search_results': 'Geen zoekresultaten',
                'no_results_title': 'Geen studenten gevonden',
                'no_results_suggestions': 'Probeer het opnieuw met:',
                'suggestion_partial': '• Alleen je voornaam',
                'suggestion_caps': '• Verschillende hoofdletters',
                'suggestion_contact': '• Neem contact op als je je naam niet kunt vinden',
                'try_again': 'Opnieuw proberen',
                'hero_title': 'Vind je aantekeningen in seconden',
                'hero_description': 'Alle je notities, georganiseerd en direct toegankelijk. Voer gewoon je naam in en vind al je lesmateriaal.',
                'search_placeholder_hero': 'Typ je naam om je aantekeningen te vinden...',
                'search_button_hero': 'Zoeken',
                'feature_fast': 'Snel zoeken',
                'feature_secure': 'Privacy veilig',
                'feature_mobile': 'Mobiel vriendelijk'
            },
            'en': {
                'search_placeholder': 'Type your name to find your notes...',
                'search_button': '🔍 Search',
                'loading': 'Loading...',
                'no_results': 'No students found',
                'try_again': 'Try a different name or check the spelling.',
                'students_found': 'students found',
                'student_found': 'student found',
                'last_activity': 'Last activity',
                'files': 'Files',
                'click_to_view': '👆 Click to view details',
                'back_to_search': '← Back to search',
                'icon_view': 'Icon View',
                'list_view': 'List View',
                'no_files': 'No files found in this folder.',
                'error_loading': 'Error loading files. Please try again.',
                'error_loading_files': 'Error loading',
                'hover_to_load': 'Hover to load',
                'latest_note': 'Latest note',
                'preview': 'Preview',
                'download': 'Download',
                'all_files': 'All files',
                'subject': 'Subject',
                'topic': 'Topic',
                'level': 'Level',
                'keywords': 'Keywords',
                'summary': 'Summary',
                'filter_subject': 'Filter by subject',
                'filter_year': 'Filter by school year',
                'clear_filters': 'Clear filters',
                'all_subjects': 'All subjects',
                'all_years': 'All school years',
                'share_notes': 'Share your notes',
                'share_whatsapp': 'Share via WhatsApp',
                'share_email': 'Share via email',
                'copy_link': 'Copy link',
                'link_copied': 'Link copied!',
                'share_message': 'Check out my notes from Stephen\'s Privelessen:',
                'enter_name_to_search': 'Enter a name to search',
                'no_notes_found': 'No notes found',
                'no_files_available': 'No files are available for this student yet.',
                'no_search_results': 'No search results',
                'no_results_title': 'No students found',
                'no_results_suggestions': 'Try searching with:',
                'suggestion_partial': '• Just your first name',
                'suggestion_caps': '• Different capitalization',
                'suggestion_contact': '• Contact us if you can\'t find your name',
                'try_again': 'Try again',
                'hero_title': 'Find your notes in seconds',
                'hero_description': 'All your notes, organized and directly accessible. Just enter your name and find all your study materials.',
                'search_placeholder_hero': 'Type your name to find your notes...',
                'search_button_hero': 'Search',
                'feature_fast': 'Fast search',
                'feature_secure': 'Privacy safe',
                'feature_mobile': 'Mobile friendly'
            }
        };
        
        // Language functions
        function setLanguage(lang) {
            console.log('setLanguage called with:', lang);
            currentLanguage = lang;
            
            // Update active button
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            const activeBtn = document.getElementById('lang' + lang.charAt(0).toUpperCase() + lang.slice(1));
            if (activeBtn) {
                activeBtn.classList.add('active');
                console.log('Language button updated');
            } else {
                console.error('Language button not found for:', lang);
            }
            
            // Update UI elements
            updateUI();
            
            // Refresh current view if student is selected
            if (currentStudent && currentFiles.length > 0) {
                // Refresh share section
                const shareSection = document.getElementById('share-section');
                if (shareSection) {
                    const shareTitle = shareSection.querySelector('.share-title');
                    const shareButtons = shareSection.querySelector('.share-buttons');
                    if (shareTitle) shareTitle.textContent = t('share_notes');
                    if (shareButtons) {
                        shareButtons.innerHTML = `
                            <button class="share-btn whatsapp" onclick="shareViaWhatsApp()">
                                📱 ${t('share_whatsapp')}
                            </button>
                            <button class="share-btn email" onclick="shareViaEmail()">
                                📧 ${t('share_email')}
                            </button>
                            <button class="share-btn copy" onclick="copyShareLink()">
                                📋 ${t('copy_link')}
                            </button>
                        `;
                    }
                }
                
                // Refresh featured note
                showFeaturedNote(currentFiles);
                
                // Refresh files display
                const filteredFiles = applyFiltersToFiles(currentFiles);
                if (currentView === 'icon') {
                    displayIconView(filteredFiles);
                } else {
                    displayListView(filteredFiles);
                }
            }
        }
        
        function updateUI() {
            const t = translations[currentLanguage];
            
            // Update hero section
            const heroTitle = document.getElementById('hero-title');
            const heroDescription = document.getElementById('hero-description');
            const searchInput = document.getElementById('searchInput');
            const searchText = document.getElementById('search-text');
            const featureFast = document.getElementById('feature-fast');
            const featureSecure = document.getElementById('feature-secure');
            const featureMobile = document.getElementById('feature-mobile');
            
            if (heroTitle) {
                const gradientText = heroTitle.querySelector('.gradient-text');
                if (gradientText) {
                    heroTitle.innerHTML = t.hero_title.replace('aantekeningen', '<span class="gradient-text">aantekeningen</span>');
                } else {
                    heroTitle.textContent = t.hero_title;
                }
            }
            if (heroDescription) heroDescription.textContent = t.hero_description;
            if (searchInput) searchInput.placeholder = t.search_placeholder_hero;
            if (searchText) searchText.textContent = t.search_button_hero;
            if (featureFast) featureFast.textContent = t.feature_fast;
            if (featureSecure) featureSecure.textContent = t.feature_secure;
            if (featureMobile) featureMobile.textContent = t.feature_mobile;
        }
        
        function t(key) {
            return translations[currentLanguage][key] || key;
        }
        
        // Debounced search function
        let searchTimeout;
        function debouncedSearch() {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                const input = document.getElementById('searchInput');
                const searchTerm = input.value.trim();
                
                if (searchTerm.length >= 2) {
                    performSearch(searchTerm);
                } else if (searchTerm.length === 0) {
                    // Clear results when input is empty
                    const resultsDiv = document.getElementById('results');
                    resultsDiv.innerHTML = '';
                }
            }, 300); // 300ms delay
        }
        
        // Main search functionality
        function searchStudents() {
            console.log('searchStudents function called');
            
            const input = document.getElementById('searchInput');
            const searchTerm = input.value.trim();
            
            if (!searchTerm) {
                console.log('No search term provided');
                const resultsDiv = document.getElementById('results');
                resultsDiv.innerHTML = '<div class="error">' + t('enter_name_to_search') + '</div>';
                return;
            }
            
            performSearch(searchTerm);
        }
        
        // Perform the actual search
        function performSearch(searchTerm) {
            const resultsDiv = document.getElementById('results');
            const searchBtn = document.getElementById('searchBtn');
            
            console.log('Performing search for:', searchTerm);
            
            // Show loading
            searchBtn.disabled = true;
            searchBtn.textContent = '⏳ Loading...';
            resultsDiv.innerHTML = 
                '<div class="loading">' +
                    '<div class="spinner"></div>' +
                    '<p>Loading...</p>' +
                '</div>';
            
            console.log('About to call Google Apps Script...');
            console.log('google object:', typeof google);
            console.log('google.script:', typeof google?.script);
            console.log('google.script.run:', typeof google?.script?.run);
            
            // Check if Google Apps Script is available
            if (typeof google === 'undefined' || !google.script || !google.script.run) {
                console.error('Google Apps Script not available');
                resultsDiv.innerHTML = 
                    '<div class="error">' +
                        'Google Apps Script not available. This might be a deployment issue.' +
                        '<br><br>' +
                        'Search term was: "' + searchTerm + '"' +
                        '<br>' +
                        'Please check the console for more details.' +
                    '</div>';
                searchBtn.disabled = false;
                searchBtn.textContent = '🔍 Search';
                return;
            }
            
            // Call Google Apps Script function
            try {
                google.script.run
                    .withSuccessHandler(function(result) {
                        console.log('Google Apps Script success:', result);
                        displayResults(result);
                    })
                    .withFailureHandler(function(error) {
                        console.error('Google Apps Script error:', error);
                        showError(error);
                    })
                    .findStudentFolders(searchTerm);
            } catch (error) {
                console.error('Error calling Google Apps Script:', error);
                resultsDiv.innerHTML = 
                    '<div class="error">' +
                        'Error calling Google Apps Script: ' + error.message +
                        '<br><br>' +
                        'Search term was: "' + searchTerm + '"' +
                    '</div>';
                searchBtn.disabled = false;
                searchBtn.textContent = '🔍 Search';
            }
        }
        
        // Display search results
        function displayResults(matches) {
            const resultsDiv = document.getElementById('results');
            const searchBtn = document.getElementById('searchBtn');
            
            // Hide hero section when showing search results
            const heroSection = document.querySelector('.hero-section');
            if (heroSection) {
                heroSection.style.display = 'none';
            }
            
            // Reset button
            searchBtn.disabled = false;
            searchBtn.textContent = t('search_button');
            
            currentResults = matches;
            
            if (matches.length === 0) {
                resultsDiv.innerHTML = `
                    <div class="no-results">
                        <h3>${t('no_results')}</h3>
                        <p>${t('try_again')}</p>
                    </div>
                `;
                return;
            }
            
            // If only one match, auto-open the student
            if (matches.length === 1) {
                const student = matches[0];
                showStudentDetail(student.folderId, student.name, student.subject);
                return;
            }
            
            // Show stats
            const statsHtml = 
                '<div class="stats">' +
                    matches.length + ' ' + (matches.length !== 1 ? t('students_found') : t('student_found')) +
                '</div>';
            
            // Show student cards with overview info
            const studentsHtml = matches.map(student => 
                '<div class="student-card" onclick="showStudentDetail(\'' + student.id + '\', \'' + student.name + '\', \'' + student.subject + '\')">' +
                    '<div class="student-header">' +
                        '<div class="student-name">' + student.name + '</div>' +
                        '<div class="subject-badge">' + student.subject + '</div>' +
                    '</div>' +
                    '<div class="student-info">' +
                        '<div class="last-activity" id="last-activity-' + student.id + '">' +
                            '📅 ' + t('last_activity') + ': ' + t('loading') +
                        '</div>' +
                        '<div class="file-count" id="file-count-' + student.id + '">' +
                            '📄 ' + t('files') + ': ' + t('loading') +
                        '</div>' +
                    '</div>' +
                    '<div class="click-hint">' +
                        t('click_to_view') +
                    '</div>' +
                '</div>'
            ).join('');
            
            resultsDiv.innerHTML = statsHtml + studentsHtml;
            
            // Load file info for first 3 students immediately, rest on demand
            matches.slice(0, 3).forEach((student, index) => {
                setTimeout(() => {
                    loadStudentOverview(student.id);
                }, index * 200 + 100);
            });
            
            // For remaining students, show placeholder and load on hover
            matches.slice(3).forEach(student => {
                const lastActivityDiv = document.getElementById('last-activity-' + student.id);
                const fileCountDiv = document.getElementById('file-count-' + student.id);
                
                if (lastActivityDiv && fileCountDiv) {
                    lastActivityDiv.textContent = '📅 ' + t('hover_to_load');
                    fileCountDiv.textContent = '📄 ' + t('hover_to_load');
                    
                    // Add hover event to load on demand
                    const studentCard = document.querySelector('[onclick*="' + student.id + '"]');
                    if (studentCard) {
                        studentCard.addEventListener('mouseenter', () => {
                            if (lastActivityDiv.textContent.includes(t('hover_to_load'))) {
                                loadStudentOverview(student.id);
                            }
                        });
                    }
                }
            });
        }
        
        // Load student overview data
        function loadStudentOverview(folderId) {
            google.script.run
                .withSuccessHandler(overview => updateStudentOverviewFromOverview(folderId, overview))
                .withFailureHandler(error => updateStudentOverviewError(folderId, error))
                .getStudentOverview(folderId);
        }
        
        // Update student overview with file count and last activity
        function updateStudentOverviewFromOverview(folderId, overview) {
            const lastActivityDiv = document.getElementById('last-activity-' + folderId);
            const fileCountDiv = document.getElementById('file-count-' + folderId);
            
            if (!lastActivityDiv || !fileCountDiv) {
                console.error('DOM elements not found for folder:', folderId, 'retrying in 500ms...');
                setTimeout(() => {
                    updateStudentOverviewFromOverview(folderId, overview);
                }, 500);
                return;
            }
            
            if (!overview) {
                console.error('Overview is null or undefined for folder:', folderId);
                lastActivityDiv.textContent = '❌ ' + t('error_loading_files');
                fileCountDiv.textContent = '❌ ' + t('error_loading_files');
                return;
            }
            
            if (overview.fileCount > 0) {
                lastActivityDiv.textContent = '📅 ' + t('last_activity') + ': ' + overview.lastActivityDate;
                fileCountDiv.textContent = '📄 ' + t('files') + ': ' + overview.fileCount;
            } else {
                lastActivityDiv.textContent = '📅 Geen bestanden gevonden';
                fileCountDiv.textContent = '📄 ' + t('files') + ': 0';
            }
        }
        
        // Update student overview with error
        function updateStudentOverviewError(folderId, error) {
            const lastActivityDiv = document.getElementById('last-activity-' + folderId);
            const fileCountDiv = document.getElementById('file-count-' + folderId);
            
            if (!lastActivityDiv || !fileCountDiv) {
                console.error('DOM elements not found for error update, folder:', folderId);
                return;
            }
            
            lastActivityDiv.textContent = `❌ ${t('error_loading_files')}`;
            fileCountDiv.textContent = `❌ ${t('error_loading_files')}`;
        }
        
        // Show student detail view
        function showStudentDetail(folderId, studentName, subject) {
            currentStudent = { id: folderId, name: studentName, subject: subject };
            
            // Hide hero section when student is selected
            const heroSection = document.querySelector('.hero-section');
            if (heroSection) {
                heroSection.style.display = 'none';
            }
            
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                 <button class="back-btn" onclick="showSearchResults()">${t('back_to_search')}</button>
                <div class="share-section" id="share-section">
                    <div class="share-header">
                         <h3 class="share-title">${t('share_notes')}</h3>
                    </div>
                    <div class="share-buttons">
                        <button class="share-btn whatsapp" onclick="shareViaWhatsApp()">
                            📱 ${t('share_whatsapp')}
                        </button>
                        <button class="share-btn email" onclick="shareViaEmail()">
                            📧 ${t('share_email')}
                        </button>
                        <button class="share-btn copy" onclick="copyShareLink()">
                            📋 ${t('copy_link')}
                        </button>
                    </div>
                    <div class="share-url" id="share-url" style="display: none;">
                        <!-- URL will be set by JavaScript -->
                    </div>
                </div>
                <div class="featured-note" id="featured-note">
                    <div class="loading">
                        <div class="spinner"></div>
                         <p>${t('loading')} ${t('latest_note')}...</p>
                    </div>
                </div>
                <div class="files-section" id="files-section" style="display: none;">
                    <div class="files-header">
                        <h2 class="files-title">${t('all_files')}</h2>
                        <div class="view-toggle">
                            <button class="toggle-btn active" onclick="switchView('icon')">${t('icon_view')}</button>
                            <button class="toggle-btn" onclick="switchView('list')">${t('list_view')}</button>
                        </div>
                    </div>
                    <div class="filters-section" id="filters-section">
                        <div class="filter-group">
                            <label class="filter-label">${t('filter_subject')}</label>
                            <select class="filter-select" id="subject-filter" onchange="applyFilters()">
                                <option value="all">${t('all_subjects')}</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">${t('filter_year')}</label>
                            <select class="filter-select" id="year-filter" onchange="applyFilters()">
                                <option value="all">${t('all_years')}</option>
                            </select>
                        </div>
                        <button class="clear-filters" onclick="clearFilters()">${t('clear_filters')}</button>
                    </div>
                    <div id="student-files">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>${t('loading')} ${t('files')}...</p>
                        </div>
                    </div>
                </div>
            `;
            
            // Load student files
            google.script.run
                .withSuccessHandler(files => {
                    displayFiles(folderId, files);
                    showFeaturedNote(files);
                })
                .withFailureHandler(error => {
                    console.error('Error loading files:', error);
                    document.getElementById('student-files').innerHTML = '<div class="error">' + t('error_loading') + '</div>';
                })
                .listFilesInFolder(folderId);
        }
        
        // Show featured note (latest note)
        function showFeaturedNote(files) {
            if (!files || files.length === 0) {
                document.getElementById('featured-note').innerHTML = '<div class="no-results"><h3>' + t('no_notes_found') + '</h3><p>' + t('no_files_available') + '</p></div>';
                return;
            }
            
            const latestFile = files[0]; // Files are sorted by date, newest first
            
            const featuredHtml = `
                <div class="featured-header">
                     <h2 class="featured-title">${t('latest_note')}</h2>
                    <div class="featured-subject">Subject</div>
                </div>
                <div class="featured-content">
                    <div class="featured-preview">
                        ${latestFile.thumbnailUrl ? 
                            `<img src="${latestFile.thumbnailUrl}" alt="Preview" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" loading="lazy">
                             <div class="file-icon" style="display: none;">📄</div>` :
                            `<div class="file-icon">📄</div>`
                        }
                    </div>
                    <div class="featured-details">
                        <div class="featured-summary">
                            <h4>${latestFile.title || latestFile.name}</h4>
                            <p>${currentLanguage === 'en' ? (latestFile.summaryEn || latestFile.summary || 'No summary available.') : (latestFile.summary || 'Geen samenvatting beschikbaar.')}</p>
                        </div>
                        <div class="featured-meta">
                            <div class="meta-item">
                                 <div class="meta-label">${t('subject')}</div>
                                <div class="meta-value">${latestFile.subject || 'Onbekend'}</div>
                            </div>
                            <div class="meta-item">
                                <div class="meta-label">${t('topic')}</div>
                                <div class="meta-value">${currentLanguage === 'en' ? (latestFile.topicEn || latestFile.topic || 'Unknown') : (latestFile.topic || 'Onbekend')}</div>
                            </div>
                            <div class="meta-item">
                                <div class="meta-label">${t('level')}</div>
                                <div class="meta-value">${latestFile.level || 'Onbekend'}</div>
                            </div>
                            ${latestFile.schoolYear ? `
                            <div class="meta-item">
                                <div class="meta-label">Schooljaar</div>
                                <div class="meta-value">${latestFile.schoolYear}</div>
                            </div>
                            ` : ''}
                        </div>
                        <div class="featured-actions">
                             <a href="${latestFile.viewUrl}" target="_blank" class="action-btn btn-primary">${t('preview')}</a>
                             <a href="${latestFile.downloadUrl}" class="action-btn btn-secondary">${t('download')}</a>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('featured-note').innerHTML = featuredHtml;
            document.getElementById('files-section').style.display = 'block';
        }
        
        // Display files
        function displayFiles(folderId, files) {
            const filesDiv = document.getElementById('student-files');
            
            if (!files || !Array.isArray(files)) {
                console.error('Files is null, undefined, or not an array for folder:', folderId, 'Files:', files);
                filesDiv.innerHTML = `<div class="error">${t('error_loading')}</div>`;
                return;
            }
            
            if (files.length === 0) {
                filesDiv.innerHTML = `<div class="no-results"><h3>${t('no_files')}</h3></div>`;
                return;
            }
            
            // Store current files for filtering
            currentFiles = files;
            
            // Populate filter options
            populateFilters(files);
            
            // Apply current filters
            const filteredFiles = applyFiltersToFiles(files);
            
            if (currentView === 'icon') {
                displayIconView(filteredFiles);
            } else {
                displayListView(filteredFiles);
            }
        }
        
        // Populate filter options
        function populateFilters(files) {
            const subjectFilter = document.getElementById('subject-filter');
            const yearFilter = document.getElementById('year-filter');
            
            // Get unique subjects
            const subjects = [...new Set(files.map(file => file.subject).filter(s => s && s !== 'Onbekend'))];
            const years = [...new Set(files.map(file => file.schoolYear).filter(y => y))];
            
            // Clear existing options (except "all")
            subjectFilter.innerHTML = `<option value="all">${t('all_subjects')}</option>`;
            yearFilter.innerHTML = `<option value="all">${t('all_years')}</option>`;
            
            // Add subject options
            subjects.forEach(subject => {
                const option = document.createElement('option');
                option.value = subject;
                option.textContent = subject;
                subjectFilter.appendChild(option);
            });
            
            // Add year options
            years.sort().reverse().forEach(year => {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearFilter.appendChild(option);
            });
        }
        
        // Apply filters to files
        function applyFiltersToFiles(files) {
            return files.filter(file => {
                const subjectMatch = currentFilters.subject === 'all' || file.subject === currentFilters.subject;
                const yearMatch = currentFilters.schoolYear === 'all' || file.schoolYear === currentFilters.schoolYear;
                return subjectMatch && yearMatch;
            });
        }
        
        // Apply filters
        function applyFilters() {
            const subjectFilter = document.getElementById('subject-filter');
            const yearFilter = document.getElementById('year-filter');
            
            currentFilters.subject = subjectFilter.value;
            currentFilters.schoolYear = yearFilter.value;
            
            const filteredFiles = applyFiltersToFiles(currentFiles);
            
            if (currentView === 'icon') {
                displayIconView(filteredFiles);
            } else {
                displayListView(filteredFiles);
            }
        }
        
        // Clear filters
        function clearFilters() {
            currentFilters.subject = 'all';
            currentFilters.schoolYear = 'all';
            
            const subjectFilter = document.getElementById('subject-filter');
            const yearFilter = document.getElementById('year-filter');
            
            subjectFilter.value = 'all';
            yearFilter.value = 'all';
            
            const filteredFiles = applyFiltersToFiles(currentFiles);
            
            if (currentView === 'icon') {
                displayIconView(filteredFiles);
            } else {
                displayListView(filteredFiles);
            }
        }
        
        // Display files in icon view
        function displayIconView(files) {
            const filesDiv = document.getElementById('student-files');
            
            const iconHtml = `
                <div class="file-grid">
                    ${files.map(file => {
                        const date = new Date(file.modifiedTime).toLocaleDateString('nl-NL', {
                            year: 'numeric',
                            month: 'short',
                            day: 'numeric'
                        });
                        
                        const displayTitle = file.title || file.name;
                        
                        return `
                            <div class="file-card" onclick="openFile('${file.viewUrl}', '${file.downloadUrl}')">
                                <div class="file-preview">
                                    ${file.thumbnailUrl ? 
                                        `<img src="${file.thumbnailUrl}" alt="Preview" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" loading="lazy">
                                         <div class="file-icon" style="display: none;">📄</div>` :
                                        `<div class="file-icon">📄</div>`
                                    }
                                </div>
                                <div class="file-name">${displayTitle}</div>
                                <div class="file-date">${date}</div>
                                ${file.subject && file.subject !== 'Onbekend' ? `
                                    <div class="file-meta">
                                        <div class="file-subject">${file.subject}</div>
                                        ${file.topic ? `<div class="file-topic">${currentLanguage === 'en' ? (file.topicEn || file.topic) : file.topic}</div>` : ''}
                                        ${file.keywords && file.keywords.length > 0 ? `
                                            <div class="file-keywords">${currentLanguage === 'en' ? (file.keywordsEn || file.keywords).slice(0, 3).join(', ') : file.keywords.slice(0, 3).join(', ')}</div>
                                        ` : ''}
                                        ${file.schoolYear ? `<div class="file-year" style="font-size: 0.7rem; color: #94a3b8; margin-top: 0.25rem;">${file.schoolYear}</div>` : ''}
                                    </div>
                                ` : ''}
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
            
            filesDiv.innerHTML = iconHtml;
        }
        
        // Display files in list view
        function displayListView(files) {
            const filesDiv = document.getElementById('student-files');
            
            const listHtml = `
                <div class="file-list">
                    ${files.map(file => {
                        const date = new Date(file.modifiedTime).toLocaleDateString('nl-NL', {
                            year: 'numeric',
                            month: 'short',
                            day: 'numeric'
                        });
                        
                        const displayTitle = file.title || file.name;
                        
                        return `
                            <div class="file-card" onclick="openFile('${file.viewUrl}', '${file.downloadUrl}')">
                                <div class="file-preview">
                                    ${file.thumbnailUrl ? 
                                        `<img src="${file.thumbnailUrl}" alt="Preview" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" loading="lazy">
                                         <div class="file-icon" style="display: none;">📄</div>` :
                                        `<div class="file-icon">📄</div>`
                                    }
                                </div>
                                <div class="file-name">${displayTitle}</div>
                                <div class="file-date">${date}</div>
                                ${file.subject && file.subject !== 'Onbekend' ? `
                                    <div class="file-meta">
                                        <div class="file-subject">${file.subject}</div>
                                        ${file.topic ? `<div class="file-topic">${currentLanguage === 'en' ? (file.topicEn || file.topic) : file.topic}</div>` : ''}
                                        ${file.keywords && file.keywords.length > 0 ? `
                                            <div class="file-keywords">${currentLanguage === 'en' ? (file.keywordsEn || file.keywords).slice(0, 3).join(', ') : file.keywords.slice(0, 3).join(', ')}</div>
                                        ` : ''}
                                        ${file.schoolYear ? `<div class="file-year" style="font-size: 0.7rem; color: #94a3b8; margin-top: 0.25rem;">${file.schoolYear}</div>` : ''}
                                    </div>
                                ` : ''}
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
            
            filesDiv.innerHTML = listHtml;
        }
        
        // Switch view between icon and list
        function switchView(view) {
            currentView = view;
            
            // Update toggle buttons
            document.querySelectorAll('.toggle-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Reload files with new view
            if (currentStudent) {
                google.script.run
                    .withSuccessHandler(files => displayFiles(currentStudent.id, files))
                    .withFailureHandler(error => {
                        console.error('Error reloading files:', error);
                        document.getElementById('student-files').innerHTML = '<div class="error">' + t('error_loading') + '</div>';
                    })
                    .listFilesInFolder(currentStudent.id);
            }
        }
        
        // Open file
        function openFile(viewUrl, downloadUrl) {
            window.open(viewUrl, '_blank');
        }
        
        // Show search results again
        function showSearchResults() {
            // Show hero section again when going back to search
            const heroSection = document.querySelector('.hero-section');
            if (heroSection) {
                heroSection.style.display = 'flex';
            }
            
            if (currentResults && currentResults.length > 0) {
                displayResults(currentResults);
            } else {
                document.getElementById('results').innerHTML = 
                    '<div class="no-results">' +
                        '<div class="no-results-icon">🔍</div>' +
                        '<h3>' + t('no_results_title') + '</h3>' +
                        '<p>' + t('no_results_suggestions') + '</p>' +
                        '<ul class="suggestions-list">' +
                            '<li>' + t('suggestion_partial') + '</li>' +
                            '<li>' + t('suggestion_caps') + '</li>' +
                            '<li>' + t('suggestion_contact') + '</li>' +
                        '</ul>' +
                        '<div class="search-again">' +
                            '<button onclick="clearSearch()" class="retry-button">' + t('try_again') + '</button>' +
                        '</div>' +
                    '</div>';
            }
        }
        
        // Clear search function
        function clearSearch() {
            document.getElementById('searchInput').value = '';
            document.getElementById('searchInput').focus();
            document.getElementById('results').innerHTML = '';
            currentResults = [];
        }
        
        // Share functions
        function shareViaWhatsApp() {
            const shareUrl = window.location.href;
            const message = encodeURIComponent(t('share_message') + ' ' + shareUrl);
            const whatsappUrl = 'https://wa.me/?text=' + message;
            window.open(whatsappUrl, '_blank');
        }
        
        function shareViaEmail() {
            const shareUrl = window.location.href;
            const subject = encodeURIComponent(currentStudent.name + ' - ' + t('share_notes'));
            const body = encodeURIComponent(t('share_message') + '\n\n' + shareUrl);
            const emailUrl = 'mailto:?subject=' + subject + '&body=' + body;
            window.location.href = emailUrl;
        }
        
        function copyShareLink() {
            const shareUrl = window.location.href;
            
            // Try to use the modern clipboard API
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(shareUrl).then(() => {
                    showCopySuccess();
                }).catch(() => {
                    fallbackCopyTextToClipboard(shareUrl);
                });
            } else {
                fallbackCopyTextToClipboard(shareUrl);
            }
        }
        
        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";
            textArea.style.left = "-999999px";
            textArea.style.top = "-999999px";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                showCopySuccess();
            } catch (err) {
                console.error('Failed to copy text: ', err);
                alert('Failed to copy link. Please copy manually: ' + text);
            }
            
            document.body.removeChild(textArea);
        }
        
        function showCopySuccess() {
            // Remove existing success message
            const existing = document.querySelector('.copy-success');
            if (existing) {
                existing.remove();
            }
            
            // Create new success message
            const successDiv = document.createElement('div');
            successDiv.className = 'copy-success';
            successDiv.textContent = t('link_copied');
            document.body.appendChild(successDiv);
            
            // Remove after 3 seconds
            setTimeout(() => {
                if (successDiv.parentNode) {
                    successDiv.parentNode.removeChild(successDiv);
                }
            }, 3000);
        }
        
        // Show error
        function showError(error) {
            const resultsDiv = document.getElementById('results');
            const searchBtn = document.getElementById('searchBtn');
            
            searchBtn.disabled = false;
            searchBtn.textContent = t('search_button');
            
            resultsDiv.innerHTML = 
                '<div class="error">' +
                    'Er is een fout opgetreden: ' + (error.message || error) +
                '</div>';
        }
        
        // Test function
        function testFunction() {
            console.log('Test function called successfully!');
            alert('Test function works!');
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing...');
            console.log('Current URL:', window.location.href);
            console.log('User agent:', navigator.userAgent);
            
            updateUI();
            
            // Test if buttons are working
            const searchBtn = document.getElementById('searchBtn');
            if (searchBtn) {
                console.log('Search button found');
                searchBtn.addEventListener('click', function(e) {
                    console.log('Search button clicked', e);
                    e.preventDefault();
                    searchStudents();
                });
            } else {
                console.error('Search button not found');
            }
            
            // Test search input
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                // Add live search functionality
                searchInput.addEventListener('input', function(e) {
                    console.log('Search input changed:', e.target.value);
                    debouncedSearch();
                });
                
                // Keep Enter key functionality
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        console.log('Enter pressed in search input');
                        searchStudents();
                    }
                });
            }
            
            // Add language button event listeners
            const langNl = document.getElementById('langNl');
            const langEn = document.getElementById('langEn');
            
            if (langNl) {
                langNl.addEventListener('click', function() {
                    console.log('NL button clicked');
                    setLanguage('nl');
                });
            }
            
            if (langEn) {
                langEn.addEventListener('click', function() {
                    console.log('EN button clicked');
                    setLanguage('en');
                });
            }
        });
    </script>
</body>
</html>